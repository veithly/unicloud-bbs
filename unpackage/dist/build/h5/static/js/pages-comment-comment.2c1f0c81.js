(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-comment-comment"],{"028d":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={data:function(){return{loading:!1,count:0}},mounted:function(){var t=this,e=function(e){return t.count=e||t.count};this.emitFn(e,this.vid)},props:{emitFn:{type:Function,default:function(){}},vid:{type:String,default:""}},methods:{useLoading:function(){var t=this;return this.loading=!0,function(){return t.loading=!1}}}};e.default=a},"037b":function(t,e,n){"use strict";n.r(e);var a=n("4b67"),i=n("4aae");for(var r in i)"default"!==r&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("a1e2");var o,c=n("f0c5"),u=Object(c["a"])(i["default"],a["b"],a["c"],!1,null,"45fa1794",null,!1,a["a"],o);e["default"]=u.exports},"1fef":function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,".seat[data-v-da90e07a]{height:15vh}",""]),t.exports=e},"214c":function(t,e,n){"use strict";var a=n("9154"),i=n.n(a);i.a},2951:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={data:function(){return{commentCount:0}},props:{v:{type:Object,default:function(){return{}}},selectActive:{type:Boolean,default:!1},disabledCommentIcon:{type:Boolean,default:!1},requestFn:{type:Function,default:function(){}}},created:function(){this.requestFn(this)},computed:{selectActiveColor:function(){var t=this.selectActive;return t?"input-bg-color rounded":""}},methods:{activeColor:function(t){return t?"main-color":null},praise:function(t){var e=this,n=t.useLoading(),a=function(t){return e.$U.notice(t)},i=function(){e.v.praiseStatus?e.v.praiseNum--:e.v.praiseNum++,e.v.praiseStatus=!e.v.praiseStatus},r=function(){return n()},o={commentID:this.v._id,praiseStatus:this.v.praiseStatus};this.$emit("praise",{fail:a,success:i,complete:r,payload:o})}}};e.default=a},"2c29":function(t,e,n){"use strict";n.r(e);var a=n("2951"),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},"4aae":function(t,e,n){"use strict";n.r(e);var a=n("b924"),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},"4b67":function(t,e,n){"use strict";var a;n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return a}));var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"page-header px-2 flex align-center justify-between"},[t.canBack?n("v-uni-view",{staticClass:"iconfont icon-arrowLeft-fill back-icon",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)}}}):t._e(),n("v-uni-view",{staticClass:"font-lg"},[t._v(t._s(t.title))]),t._t("default")],2)},r=[]},"60c5":function(t,e,n){"use strict";n.r(e);var a=n("74cf"),i=n("c0bc");for(var r in i)"default"!==r&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("7ead");var o,c=n("f0c5"),u=Object(c["a"])(i["default"],a["b"],a["c"],!1,null,"da90e07a",null,!1,a["a"],o);e["default"]=u.exports},"68d5":function(t,e,n){var a=n("d9bc");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("4f06").default;i("0d36a636",a,!0,{sourceMap:!1,shadowMode:!1})},7007:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return a}));var a={cImage:n("03db").default,uniDateformat:n("050d").default,cTemp:n("74f7").default,cDivider:n("53ad").default},i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.$emit("action",t.v)}}},[n("v-uni-view",{staticClass:"m-2 p-4 transition-all",class:[t.selectActiveColor]},[n("v-uni-view",{staticClass:"mx-2 mt-5 flex"},[n("c-image",{staticClass:"avatar rounded",attrs:{src:t.v.avatarUrl}}),n("v-uni-view",{staticClass:"flex flex-column ml-2"},[n("v-uni-text",[t._v(t._s(t.v.username))]),n("uni-dateformat",{staticClass:"font-sm secondary-color",attrs:{date:t.v.comment_date,format:"yyyy-MM-dd",threshold:[6e4,864e5]}})],1)],1),n("v-uni-view",{staticClass:"py-2"},[t.v.reply_username?n("v-uni-text",{staticClass:"careful-bg-color main-color p-1 mb-2 rounded font-sm"},[t._v("@"+t._s(t.v.reply_username))]):t._e(),n("v-uni-view",[t._v(t._s(t.v.comment_content))])],1),n("v-uni-view",{staticClass:"iconfont flex justify-end"},[n("v-uni-view",{staticClass:"mr-2"},[n("c-temp",{class:[t.activeColor(t.v.praiseStatus)],scopedSlots:t._u([{key:"default",fn:function(e){return[n("v-uni-text",{staticClass:"icon-dianzan action-icon mr-2",on:{click:function(n){n.stopPropagation(),arguments[0]=n=t.$handleEvent(n),t.praise(e)}}}),t.v.praiseNum?n("v-uni-text",[t._v(t._s(t.v.praiseNum))]):t._e()]}}])})],1),!t.disabledCommentIcon&&t.commentCount?n("v-uni-view",{staticClass:"mr-2"},[n("v-uni-text",{staticClass:"icon-pinglun action-icon mr-2"}),t._v(t._s(t.commentCount))],1):t._e()],1)],1),n("c-divider")],1)},r=[]},"74cf":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return a}));var a={cSticky:n("4a0a").default,cStatusBar:n("0aad").default,cPageHeader:n("037b").default,cComment:n("fa9c").default,unicloudDb:n("960d").default,cDesc:n("b9b7").default,cScrollLoadMore:n("4b83").default,uniEasyinput:n("5a54").default,cBackTop:n("048f").default},i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",[n("c-sticky",[n("c-status-bar"),n("c-page-header",{attrs:{title:"评论"}})],1),n("c-comment",{attrs:{selectActive:t.replyUser===t.mainComment,v:t.mainComment},on:{praise:function(e){arguments[0]=e=t.$handleEvent(e),t.resolveCommentPraise.apply(void 0,arguments)},action:function(e){arguments[0]=e=t.$handleEvent(e),t.resolveCommentAction.apply(void 0,arguments)}}}),n("unicloud-db",{ref:"comment",attrs:{collection:"comments,uni-id-users",where:"reply_comment_id == '"+t.mainComment._id+"' && comment_type == 1",field:t.commentsField,"page-size":4,orderby:"comment_date desc"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.data,i=e.loading,r=e.error,o=(e.options,e.hasMore);return[r?n("v-uni-view",[t._v(t._s(r.message))]):n("v-uni-view",[n("c-desc",{staticClass:"mt-4",attrs:{title:"回复评论"}}),t._l(a,(function(e){return n("c-comment",{key:e._id,attrs:{v:e,selectActive:t.replyUser===e,disabledCommentIcon:!0},on:{praise:function(e){arguments[0]=e=t.$handleEvent(e),t.resolveCommentPraise.apply(void 0,arguments)},action:function(e){arguments[0]=e=t.$handleEvent(e),t.resolveCommentAction.apply(void 0,arguments)}}})})),n("c-scroll-load-more",{attrs:{hasMore:o,loading:i}})],2)]}}])}),n("v-uni-view",{staticClass:"seat"}),n("v-uni-view",{staticClass:"position-fixed bottom-0 px-3",staticStyle:{width:"690rpx",height:"80rpx"}},[n("uni-easyinput",{staticClass:"input-bg-color rounded",attrs:{inputBorder:!1,placeholder:t.replyUserName},on:{confirm:function(e){arguments[0]=e=t.$handleEvent(e),t.replyComfirm.apply(void 0,arguments)}},model:{value:t.replyText,callback:function(e){t.replyText=e},expression:"replyText"}})],1),n("c-back-top",{attrs:{bottom:"90rpx"}})],1)},r=[]},"74f7":function(t,e,n){"use strict";n.r(e);var a=n("c507"),i=n("e607");for(var r in i)"default"!==r&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("214c");var o,c=n("f0c5"),u=Object(c["a"])(i["default"],a["b"],a["c"],!1,null,"8418bd30",null,!1,a["a"],o);e["default"]=u.exports},"7ead":function(t,e,n){"use strict";var a=n("dd12"),i=n.n(a);i.a},"872d":function(t,e,n){"use strict";var a=n("68d5"),i=n.n(a);i.a},9154:function(t,e,n){var a=n("b294");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("4f06").default;i("0f9274f0",a,!0,{sourceMap:!1,shadowMode:!1})},a1e2:function(t,e,n){"use strict";var a=n("e61b"),i=n.n(a);i.a},b294:function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,".c-loading[data-v-8418bd30]{width:%?45?%;height:%?45?%}",""]),t.exports=e},b924:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={props:{title:{type:String,default:""},canBack:{type:Boolean,default:!0}},methods:{back:function(){uni.navigateBack({delta:1})}}};e.default=a},c0bc:function(t,e,n){"use strict";n.r(e);var a=n("e091"),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},c507:function(t,e,n){"use strict";var a;n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return a}));var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[t.loading?a("v-uni-image",{staticClass:"c-loading vivify popIn",attrs:{src:n("ce4f"),mode:"aspectFill"}}):a("v-uni-view",{staticClass:"vivify popIn"},[t._t("default",null,{useLoading:t.useLoading,count:t.count})],2)],1)},r=[]},ce4f:function(t,e,n){t.exports=n.p+"static/img/loading.44d29d12.gif"},d9bc:function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,".avatar[data-v-c1ed72b0]{width:%?90?%;height:%?90?%}",""]),t.exports=e},dd12:function(t,e,n){var a=n("1fef");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("4f06").default;i("48bcaa1a",a,!0,{sourceMap:!1,shadowMode:!1})},e091:function(t,e,n){"use strict";(function(t){var a=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("5530"));n("96cf");var r=a(n("1da1")),o=a(n("770b")),c={mixins:[o.default],data:function(){var e=t.getCurrentUserInfo(),n=e.uid,a="arrayElemAt(user_id.username, 0) as username,arrayElemAt(user_id.avatar, 0) as avatarUrl,arrayElemAt(user_id._id, 0) as comment_user_id,comment_content,comment_date,size(praise_user_ids._id) as praiseNum,in('".concat(n,"',praise_user_ids._id) as praiseStatus,arrayElemAt(reply_user_id.username, 0) as reply_username");return{commentsField:a,uid:n,mainComment:{},replyUser:{},replyText:""}},onReachBottom:function(){this.$refs.comment.loadMore()},onPullDownRefresh:function(){this.$refs.comment.loadData({clear:!0},uni.stopPullDownRefresh)},onLoad:function(){this.mainComment=uni.getStorageSync("mainComment"),this.replyUser=this.mainComment},computed:{replyUserName:function(){var t=this.replyUser;return"回复: ".concat(t.username)}},methods:{replyComfirm:function(){var t=this,e=Boolean(this.replyText.length);e&&uni.showModal({content:"发布评论",confirmText:"确认",cancelText:"取消",success:function(){var e=(0,r.default)(regeneratorRuntime.mark((function e(n){var a,i,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=n.confirm,!a){e.next=17;break}return t.$U.loading(),e.prev=3,i=t.replyUser,r=i.postID,o=i.comment_user_id,i._id,e.next=7,t.$A.comment.createComment({post_id:r,comment_content:t.replyText,reply_user_id:o,reply_comment_id:t.mainComment._id});case 7:t.$U.notice("发布成功"),t.clear(),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](3),t.$U.notice(e.t0.message);case 14:return e.prev=14,t.$U.hideLoading(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[3,11,14,17]])})));function n(t){return e.apply(this,arguments)}return n}()})},resolveCommentAction:function(t){this.replyUser=t},activeColor:function(t){return t&&"main-color"},clear:function(){this.replyText="",uni.hideKeyboard()},resolveCommentPraise:function(t){var e=this;return(0,r.default)(regeneratorRuntime.mark((function n(){var a,r,o,c,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=t.fail,r=t.success,o=t.complete,c=t.payload,u=e.uid,n.prev=2,n.next=5,e.$A.comment.praise((0,i.default)({uid:u},c));case 5:r(),n.next=11;break;case 8:n.prev=8,n.t0=n["catch"](2),a(n.t0.message);case 11:return n.prev=11,o(),n.finish(11);case 14:case"end":return n.stop()}}),n,null,[[2,8,11,14]])})))()}}};e.default=c}).call(this,n("a9ff")["default"])},e525:function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,".page-header[data-v-45fa1794]{height:%?100?%}.back-icon[data-v-45fa1794]{font-size:%?50?%}",""]),t.exports=e},e607:function(t,e,n){"use strict";n.r(e);var a=n("028d"),i=n.n(a);for(var r in a)"default"!==r&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},e61b:function(t,e,n){var a=n("e525");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("4f06").default;i("b7efe37c",a,!0,{sourceMap:!1,shadowMode:!1})},fa9c:function(t,e,n){"use strict";n.r(e);var a=n("7007"),i=n("2c29");for(var r in i)"default"!==r&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("872d");var o,c=n("f0c5"),u=Object(c["a"])(i["default"],a["b"],a["c"],!1,null,"c1ed72b0",null,!1,a["a"],o);e["default"]=u.exports}}]);